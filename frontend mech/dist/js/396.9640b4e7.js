"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[396],{7216:function(t,e,s){s.r(e),s.d(e,{default:function(){return p}});var o=s(3396),c=s(7139),i=s(870),n=s(9752),l=s(6572),a=s(1888),k=s(1334);function r(t,e,s,r,h,d){return(0,o.wg)(),(0,o.iD)("div",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(h.tickets,(t=>((0,o.wg)(),(0,o.j4)(n._,{key:t.ticketID},{default:(0,o.w5)((()=>[(0,o.Wm)(l.E,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,c.zw)(t.ticketID),1)])),_:2},1024),(0,o.Wm)(a.Z,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,c.zw)(t),1)])),_:2},1024),(0,o.Wm)(k.h,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i.T,{flat:"",onClick:e=>d.acceptTicket(t)},{default:(0,o.w5)((()=>[(0,o.Uk)("accept")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])}s(7658);var h={data(){return{tickets:[]}},mounted(){this.getActiveTicket(),this.socket=new WebSocket(this.$wsApi+"shop/ws/active-ticket"),console.log("Attempting Connection..."),this.socket.onopen=()=>{console.log("Successfully Connected"),this.socket.send("Accepted")},this.socket.addEventListener("message",(t=>{console.log("Message from server ",t.data),this.getActiveTicket()})),this.socket.onclose=t=>{console.log("Socket Closed Connection: ",t),this.socket.send("Client Closed!")},this.socket.onerror=t=>{this.console.log("Socket Error: ",t)}},methods:{getActiveTicket(){this.axios.post(this.$backendApi+"shop/get-ticket-list").then((t=>{console.log(t.data),this.tickets=t.data}))},acceptTicket(t){sessionStorage.setItem("ticketID",t.ticketID);const e=new URLSearchParams({ticketID:t.ticketID,cusID:t.cus.cusID,carID:t.car.carID,problem:t.problem,shopID:sessionStorage.getItem("shopID"),lat:t.location.lat,lng:t.location.lng,description:t.description});this.axios.post(this.$backendApi+"shop/accept-ticket",e).then((t=>{console.log(t.data),this.$router.push("/example2")}))}}},d=s(89);const u=(0,d.Z)(h,[["render",r]]);var p=u}}]);
//# sourceMappingURL=396.9640b4e7.js.map